function h(e,r){return r.reduce((t,l)=>t?.[l],e)}function v(e,r,t){return r.slice(0,-1).reduce((l,n)=>/^(__proto__)$/.test(n)?{}:l[n]=l[n]||{},e)[r[r.length-1]]=t,e}function y(e,r){return r.reduce((t,l)=>{const n=l.split(".");return v(t,n,h(e,n))},{})}function b(e={}){return function(r){var t,l,n,o;const{options:{persist:i},store:u}=r;if(!i)return;const{storage:a=(t=e.storage)!=null?t:localStorage,beforeRestore:c=(l=e.beforeRestore)!=null?l:null,afterRestore:d=(n=e.afterRestore)!=null?n:null,serializer:f=(o=e.serializer)!=null?o:{serialize:JSON.stringify,deserialize:JSON.parse},key:_=u.$id,paths:g=null}=typeof i!="boolean"?i:{};c?.(r);try{const s=a.getItem(_);s&&u.$patch(f.deserialize(s))}catch{}d?.(r),u.$subscribe((s,z)=>{try{const S=Array.isArray(g)?y(z,g):z;a.setItem(_,f.serialize(S))}catch{}},{detached:!0})}}var m=b();export{m as s};
